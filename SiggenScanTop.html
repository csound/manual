<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Scanned Synthesis</title>
    <link rel="stylesheet" type="text/css" href="csound.css" />
    <link rel="stylesheet" type="text/css" href="syntax-highlighting.css" />
    <meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" />
    <link rel="home" href="index.html" title="The Canonical Csound Reference Manual" />
    <link rel="up" href="SiggenTop.html" title="Signal Generators" />
    <link rel="prev" href="SiggenSample.html" title="Sample Playback" />
    <link rel="next" href="SiggenTableacc.html" title="Table Access" />
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">Scanned Synthesis</th>
        </tr>
        <tr>
          <td width="20%" align="left"><a accesskey="p" href="SiggenSample.html">Prev</a> </td>
          <th width="60%" align="center">Signal Generators</th>
          <td width="20%" align="right"> <a accesskey="n" href="SiggenTableacc.html">Next</a></td>
        </tr>
      </table>
      <hr />
    </div>
    <div class="section">
      <div class="titlepage">
        <div>
          <div>
            <h3 class="title"><a id="SiggenScanTop"></a>Scanned Synthesis</h3>
          </div>
        </div>
      </div>
      <p>
    Scanned synthesis is a variant of physical modeling, where a network of masses connected by springs is used to generate a dynamic waveform. Developed by Bill Verplank, Rob Shaw, and Max Mathews between 1998 and 1999 at Interval Research, Inc. it is based on the psychoacoustics of how we hear and appreciate timbres and on our motor control (haptic) abilities to manipulate timbres during live performance.
  </p>
      <p>
    Scanned Synthesis involves a slow dynamic system whose frequencies of vibration are below about 15 Hz. The ear cannot hear the low frequencies of the dynamic system. So, to make audible frequencies, the "shape" of the dynamic system, along a closed path, is scanned periodically. The "shape" is converted to a sound wave whose pitch is determined by the speed of the scanning function. Pitch control is completely separate from the dynamic system control. Thus timbre and pitch are independent.
  </p>
      <p>
    This system can be looked upon as a dynamic wave table. The model can be compared to a slowly vibrating string, or a two dimensional surface obeying the wave equation.
  </p>
      <div class="mediaobject">
        <img src="images/ScannedHaptic.png" />
      </div>
      <p>  
    Verplank, Shaw and Mathews studied scanned synthesis chiefly with a finite element model of a generalized string — a collection of masses connected by springs and dampers that can be analyzed with Newton's laws. From there, they generalized a traditional string by adding dampers and springs to each mass.
  </p>
      <div class="mediaobject">
        <img src="images/ScannedFinite.png" />
      </div>
      <p>
    All parameters — mass (in the drawing above: M), damping (D), earth-spring strength (C), and string tension (T) can vary along the "string." The model is manipulated by pushing or hitting different masses (the individual samples in a very short wavetable) and by manipulating parameters. What is unique here is that the wavetable itself is a dynamic model.
  </p>
      <div class="mediaobject">
        <img src="images/ScannedHammers.png" />
      </div>
      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note: Note">
          <tr>
            <td rowspan="2" align="center" valign="top" width="25">
              <img alt="[Note]" src="images/note.png" />
            </td>
            <th align="left">Note</th>
          </tr>
          <tr>
            <td align="left" valign="top">
              <p>The term 'hammer' is chosen for the model name, but 'hammer' might not be the best metaphor. A hammer implies that you are striking it - but you are actually initializing a deformation of the surface and then setting it in motion.
      </p>
            </td>
          </tr>
        </table>
      </div>
      <p>
    You are manipulating the mechanical model at haptic rates 0-10 Hz, and independent to this, you are scanning out the wavetable at the pitch frequency. Although, the table has its own dynamics, there are no discontinuities because the model is implemented as a circular string, so you end up with a looping oscillator (for example of 128 points) with a constantly evolving loop. It is hard to believe, but true, that what results is a short sample that is animated and harmonically rich because of the complex interactive nature of the elements in the underlying system — the mechanics of the model.
  </p>
      <div class="mediaobject">
        <img src="images/ScannedCircular.png" />
      </div>
      <p>
    In fact, even enveloping can come directly from the model. It turns out that the specific setting of the centering springs can affect the damping of the system — low values allowing the rich timbre to ring, high values causing the tone to die away quickly.
  </p>
      <p>
    The opcodes <a class="link" href="scanu.html" title="scanu"><em class="citetitle">scanu</em></a> / <a class="link" href="scanu2.html" title="scanu2"><em class="citetitle">scanu2</em></a> define the mass/spring network and sets it in motion. The opcode <a class="link" href="scans.html" title="scans"><em class="citetitle">scans</em></a> follows a predefined path (trajectory) around the network and outputs the detected waveform. Several <span class="emphasis"><em>scans</em></span> instances may follow different paths around the same network. These are highly efficient mechanical modelling algorithms for both synthesis and sonic animation via algorithmic processing. They should run in real-time. Thus, the output is useful either directly as audio, or as controller values for other parameters.
  </p>
      <p>
    The Csound implementation adds support for a scanning path or matrix.  Essentially, this offers the possibility of reconnecting the masses in different orders, causing the signal to propagate quite differently. They do not necessarily need to be connected to their direct neighbors. Essentially, the matrix has the effect of <span class="quote">“<span class="quote">molding</span>”</span> this surface into a radically different shape.
  </p>
      <p>
    Two different matrix formats are available: a binary matrix and a text matrix. It is good practise to give the binary matrix name the extension .matrxB and the text matrix .matrxT. To produce the matrices, the table formats are straightforward. 
  </p>
      <p>
As an example for the binary matrix, for 4 masses we have the following grid describing the possible connections:
  </p>
      <div class="informaltable">
        <table class="informaltable" border="1">
          <colgroup>
            <col />
            <col />
            <col />
            <col />
            <col />
          </colgroup>
          <tbody>
            <tr>
              <td> </td>
              <td>1</td>
              <td>2</td>
              <td>3</td>
              <td>4</td>
            </tr>
            <tr>
              <td>1</td>
              <td> </td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td>2</td>
              <td> </td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td>3</td>
              <td> </td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
            <tr>
              <td>4</td>
              <td> </td>
              <td> </td>
              <td> </td>
              <td> </td>
            </tr>
          </tbody>
        </table>
      </div>
      <p>
    Whenever two masses are connected, the point they define is 1. If two masses are not connected, then the point they define is 0. For example, a unidirectional string has the following connections: (1,2), (2,3), (3,4). If it is bidirectional, it also has (2,1), (3,2), (4,3)).  For the unidirectional string, the matrix appears:
  </p>
      <div class="informaltable">
        <table class="informaltable" border="1">
          <colgroup>
            <col />
            <col />
            <col />
            <col />
            <col />
          </colgroup>
          <tbody>
            <tr>
              <td> </td>
              <td>1</td>
              <td>2</td>
              <td>3</td>
              <td>4</td>
            </tr>
            <tr>
              <td>1</td>
              <td>0</td>
              <td>1</td>
              <td>0</td>
              <td>0</td>
            </tr>
            <tr>
              <td>2</td>
              <td>0</td>
              <td>0</td>
              <td>1</td>
              <td>0</td>
            </tr>
            <tr>
              <td>3</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>1</td>
            </tr>
            <tr>
              <td>4</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
              <td>0</td>
            </tr>
          </tbody>
        </table>
      </div>
      <p>
    The above table format of the connection matrix is for conceptual convenience only. The actual values shown in te table are obtained by <span class="emphasis"><em>scans</em></span> from an ASCII file using <a class="link" href="GEN23.html" title="GEN23"><em class="citetitle">GEN23</em></a>. The actual ASCII file is created from the table model row by row. Therefore the ASCII file for the example table shown above becomes:
    </p>
      <div class="literallayout">
        <p><br />
0100001000010000<br />
    </p>
      </div>
      <p>
  </p>
      <p>
    As an example of a text matrix (see <a class="link" href="GEN44.html" title="GEN44"><em class="citetitle">GEN44</em></a>), for the same 4 masses we have the following grid describing these connections:
  </p>
      <div class="informalexample">
        <pre class="programlisting">
&lt;MATRIX size=4&gt;
1   2   4 
2   3   2 
3   4   6 
&lt;/MATRIX&gt;
        </pre>
      </div>
      <p>
      Here, the first two values in the row denote a connection from the first to the second.
      The third number is a weight; a weight of 2 is like having two links so more
      information gets distributed, while a zero weight means no link. If this third 
      number is omitted it is taken as value 1. 
  </p>
      <p>
    Both these matrix examples are very small and simple. In practice, most scanned synthesis instruments will use many more masses than four, so their matrices will be much larger and more complex. See the example in the <a class="link" href="scans.html" title="scans"><em class="citetitle">scans</em></a> documentation.
  </p>
      <div class="refsect1">
        <a id="idm5851"></a>
        <p>
      Here is an example that compares the binary and the text matrix. They sound the same. It uses the file <a class="ulink" href="examples/matrices_compare.csd" target="_top"><em class="citetitle">matrices_compare.csd</em></a>.
      </p>
        <div class="example">
          <a id="idm5855"></a>
          <p class="title">
            <strong>Example 3. Example comparing the use of the binary and the text matrix.</strong>
          </p>
          <div class="example-contents">
            <div class="refsect1">
              <a id="idm5857"></a>
              <pre class="programlisting">
<span class="nt">&lt;CsoundSynthesizer&gt;</span>
<span class="nt">&lt;CsOptions&gt;</span>
-o dac
<span class="nt">&lt;/CsOptions&gt;</span>
<span class="nt">&lt;CsInstruments&gt;</span><span class="w">

</span><span class="vg">sr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">44100</span><span class="w">
</span><span class="vg">ksmps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="w">
</span><span class="vg">nchnls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="vg">0dbfs</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">

</span><span class="kd">instr</span><span class="w"> </span><span class="nf">1</span><span class="w">

</span>i<span class="n">nitial</span><span class="w"> </span><span class="nb">ftgen</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w">                         </span><span class="c1">; initial position = sine wave</span><span class="w">
</span>i<span class="n">displ</span><span class="w">  </span><span class="nb">ftgen</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mf">.01</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="mf">.01</span><span class="w">             </span><span class="c1">; displace</span><span class="w">
</span>i<span class="n">mass</span><span class="w">   </span><span class="nb">ftgen</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="mi">5</span><span class="w">                 </span><span class="c1">; masses</span><span class="w">
</span>i<span class="n">cent</span><span class="w">   </span><span class="nb">ftgen</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w">                 </span><span class="c1">; centering</span><span class="w">
</span>i<span class="n">damp</span><span class="w">   </span><span class="nb">ftgen</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">.1</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">.1</span><span class="w">             </span><span class="c1">; damping</span><span class="w">
</span>i<span class="n">traj</span><span class="w">   </span><span class="nb">ftgen</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="mi">127</span><span class="w">               </span><span class="c1">; trajectory</span><span class="w">

</span>a<span class="n">0</span><span class="w"> </span><span class="nb">init</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span>i<span class="n">rate</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">.01</span><span class="w">
      
</span><span class="c1">;scanu2 init, irate, ifndisplace, ifnmass, imatrix, ifncentr, ifndamp, kmass, kmtrxstiff, kcentr, kdamp, ileft, iright, kpos, kdisplace, ain, idisp, id</span><span class="w">
</span><span class="nb">scanu2</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="w">   </span>i<span class="n">rate</span><span class="p">,</span><span class="w">     </span><span class="mi">2</span><span class="p">,</span><span class="w">          </span><span class="mi">3</span><span class="p">,</span><span class="w">       </span><span class="vi">p4</span><span class="p">,</span><span class="w">       </span><span class="mi">4</span><span class="p">,</span><span class="w">       </span><span class="mi">5</span><span class="p">,</span><span class="w">      </span><span class="mi">20</span><span class="p">,</span><span class="w">      </span><span class="mi">9</span><span class="p">,</span><span class="w">       </span><span class="mf">0.1</span><span class="p">,</span><span class="w">    </span><span class="mf">.9</span><span class="p">,</span><span class="w">     </span><span class="mf">.5</span><span class="p">,</span><span class="w">    </span><span class="mf">.1</span><span class="p">,</span><span class="w">     </span><span class="mi">0</span><span class="p">,</span><span class="w">      </span><span class="mi">0</span><span class="p">,</span><span class="w">     </span>a<span class="n">0</span><span class="p">,</span><span class="w">    </span><span class="mi">0</span><span class="p">,</span><span class="w">   </span><span class="mi">2</span><span class="w">
</span><span class="c1">;ar scans kamp, kfreq, ifntraj, id</span><span class="w">
</span>a<span class="n">1</span><span class="w"> </span><span class="nb">scans</span><span class="w">    </span><span class="mi">1</span><span class="p">,</span><span class="w">   </span><span class="mi">200</span><span class="p">,</span><span class="w">    </span><span class="mi">6</span><span class="p">,</span><span class="w">     </span><span class="mi">2</span><span class="w">

</span><span class="k">if</span><span class="w"> </span><span class="vi">p4</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="k">then</span><span class="w">
    </span><span class="nb">prints</span><span class="w">  </span><span class="s">"</span><span class="se">\n</span><span class="s">  using binary matrix system</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="vi">p4</span><span class="w">
</span><span class="k">else</span><span class="w">
    </span><span class="nb">prints</span><span class="w">  </span><span class="s">"</span><span class="se">\n</span><span class="s">  and now the text matrix system</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span><span class="w"> </span><span class="vi">p4</span><span class="w">
</span><span class="k">endif</span><span class="w">

</span><span class="nb">outs</span><span class="w"> </span>a<span class="n">1</span><span class="p">,</span><span class="w"> </span>a<span class="n">1</span><span class="w">
</span><span class="kd">endin</span><span class="w">

</span><span class="nt">&lt;/CsInstruments&gt;</span>
<span class="nt">&lt;CsScore&gt;</span><span class="w">
</span><span class="c1">; both matrices are to be found in the examples folder of the manual</span><span class="w">
</span><span class="nb">f</span><span class="mi">50</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">16384</span><span class="w"> </span><span class="o">-</span><span class="mi">23</span><span class="w">  </span><span class="s">"string-128.matrxB"</span><span class="w">    </span><span class="c1">; binary matrix</span><span class="w">
</span><span class="nb">f</span><span class="mi">100</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">128</span><span class="w">  </span><span class="o">-</span><span class="mi">44</span><span class="w">  </span><span class="s">"string-128.matrxT"</span><span class="w">    </span><span class="c1">; text matrix</span><span class="w">

</span><span class="nb">i</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">10</span><span class="w">     </span><span class="mi">50</span><span class="w">
</span><span class="nb">i</span><span class="mi">1</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="mi">10</span><span class="w">    </span><span class="mi">100</span><span class="w">
</span><span class="nb">e</span><span class="w">
</span><span class="nt">&lt;/CsScore&gt;</span>
<span class="nt">&lt;/CsoundSynthesizer&gt;</span>
</pre>
            </div>
          </div>
        </div>
        <p><br class="example-break" />
    </p>
      </div>
      <p>
    Please note that generated dynamic wavetables can be very unstable. Certain values for masses, centering, and damping can cause the system to <span class="quote">“<span class="quote">blow up</span>”</span> and the most interesting sounds to emerge from your loudspeakers!
  </p>
      <p>
    A tutorial, examples, and other information on scanned synthesis is available from the Scanned Synthesis page at <a class="ulink" href="http://www.csounds.com/scanned/toot/index.html" target="_top"><em class="citetitle">cSounds.com</em></a>.
  </p>
      <p>
    Opcodes that implement scanned synthesis are:
    </p>
      <div class="itemizedlist">
        <ul class="itemizedlist" style="list-style-type: disc; ">
          <li class="listitem">
            <p>
              <a class="link" href="scanhammer.html" title="scanhammer">
                <em class="citetitle">scanhammer</em>
              </a>
            </p>
          </li>
          <li class="listitem">
            <p>
              <a class="link" href="scans.html" title="scans">
                <em class="citetitle">scans</em>
              </a>
            </p>
          </li>
          <li class="listitem">
            <p>
              <a class="link" href="scantable.html" title="scantable">
                <em class="citetitle">scantable</em>
              </a>
            </p>
          </li>
          <li class="listitem">
            <p>
              <a class="link" href="scanu.html" title="scanu">
                <em class="citetitle">scanu</em>
              </a>
            </p>
          </li>
          <li class="listitem">
            <p>
              <a class="link" href="scanu2.html" title="scanu2">
                <em class="citetitle">scanu2</em>
              </a>
            </p>
          </li>
          <li class="listitem">
            <p>
              <a class="link" href="scanmap.html" title="scanmap">
                <em class="citetitle">scanmap</em>
              </a>
            </p>
          </li>
          <li class="listitem">
            <p>
              <a class="link" href="scansmap.html" title="scansmap">
                <em class="citetitle">scansmap</em>
              </a>
            </p>
          </li>
          <li class="listitem">
            <p>
              <a class="link" href="GEN44.html" title="GEN44">
                <em class="citetitle">GEN44</em>
              </a>
            </p>
          </li>
        </ul>
      </div>
      <p>
  </p>
    </div>
    <div class="navfooter">
      <hr />
      <table width="100%" summary="Navigation footer">
        <tr>
          <td width="40%" align="left"><a accesskey="p" href="SiggenSample.html">Prev</a> </td>
          <td width="20%" align="center">
            <a accesskey="u" href="SiggenTop.html">Up</a>
          </td>
          <td width="40%" align="right"> <a accesskey="n" href="SiggenTableacc.html">Next</a></td>
        </tr>
        <tr>
          <td width="40%" align="left" valign="top">Sample Playback </td>
          <td width="20%" align="center">
            <a accesskey="h" href="index.html">Home</a>
          </td>
          <td width="40%" align="right" valign="top"> Table Access</td>
        </tr>
      </table>
    </div>
  </body>
</html>
