<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>opcode</title>
    <link rel="stylesheet" type="text/css" href="csound.css" />
    <link rel="stylesheet" type="text/css" href="syntax-highlighting.css" />
    <meta name="generator" content="DocBook XSL Stylesheets Vsnapshot" />
    <link rel="home" href="index.html" title="The Canonical Csound Reference Manual" />
    <link rel="up" href="OpcodesTop.html" title="Orchestra Opcodes and Operators" />
    <link rel="prev" href="olabuffer.html" title="olabuffer" />
    <link rel="next" href="oscbnk.html" title="oscbnk" />
  </head>
  <body>
    <div class="navheader">
      <table width="100%" summary="Navigation header">
        <tr>
          <th colspan="3" align="center">opcode</th>
        </tr>
        <tr>
          <td width="20%" align="left"><a accesskey="p" href="olabuffer.html">Prev</a> </td>
          <th width="60%" align="center">Orchestra Opcodes and Operators</th>
          <td width="20%" align="right"> <a accesskey="n" href="oscbnk.html">Next</a></td>
        </tr>
      </table>
      <hr />
    </div>
    <div class="refentry">
      <a id="opcode"></a>
      <div class="titlepage"></div>
      <a id="IndexOpcode" class="indexterm"></a>
      <div class="refnamediv">
        <h2>
          <span class="refentrytitle">opcode</span>
        </h2>
        <p>opcode — 
      Defines the start of user-defined opcode block.
    </p>
      </div>
      <div class="refsect1">
        <a id="idm224071"></a>
        <h2>Defining opcodes</h2>
        <p>
      The <span class="emphasis"><em>opcode</em></span> and <span class="emphasis"><em>endop</em></span> statements allow defining a new opcode that can be used the same way as any of the built-in Csound opcodes. These opcode blocks are very similar to instruments (and are, in fact, implemented as special instruments), but cannot be called as a normal instrument e.g. with the <a class="link" href="i.html" title="i Statement (Instrument or Note Statement)"><em class="citetitle">i statements</em></a>.
    </p>
        <p>
      A user-defined opcode block must precede the instrument (or other opcode) from which it is used. But it is possible to call the opcode from itself. This allows recursion of any depth that is limited only by available memory. 
    </p>
        <p>
      Similarly to instruments, the variables and labels of a user-defined opcode block are local and cannot be accessed from the caller instrument (and the opcode cannot access variables of the caller, either).
    </p>
        <p>
      Some parameters are automatically copied at initialization, however:

      </p>
        <div class="itemizedlist">
          <ul class="itemizedlist" style="list-style-type: disc; ">
            <li class="listitem">
              <p>all p-fields up to and including the
        highest-numbered one referenced in the calling
        instrument</p>
            </li>
            <li class="listitem">
              <p>extra time (see also <a class="link" href="xtratim.html" title="xtratim"><em class="citetitle">xtratim</em></a>, <a class="link" href="linsegr.html" title="linsegr"><em class="citetitle">linsegr</em></a>, and related opcodes). This may affect the operation of <span class="emphasis"><em>linsegr</em></span>/<span class="emphasis"><em>expsegr</em></span>/<span class="emphasis"><em>linenr</em></span>/<span class="emphasis"><em>envlpxr</em></span> in the user-defined opcode block.</p>
            </li>
            <li class="listitem">
              <p>MIDI parameters, if there are any.</p>
            </li>
          </ul>
        </div>
        <p>
    </p>
        <p>
      Also, the release flag (see the <a class="link" href="release.html" title="release"><em class="citetitle">release</em></a> opcode) is copied at performance time.
    </p>
        <p>
      Modifying the note duration in the opcode definition by assigning to
      <span class="emphasis"><em>p3</em></span>, or using <a class="link" href="ihold.html" title="ihold"><em class="citetitle">ihold</em></a>,
      <a class="link" href="turnoff.html" title="turnoff"><em class="citetitle">turnoff</em></a>,
      <a class="link" href="xtratim.html" title="xtratim"><em class="citetitle">xtratim</em></a>,
      <a class="link" href="linsegr.html" title="linsegr"><em class="citetitle">linsegr</em></a>,
      or similar opcodes will also affect the caller instrument.
      Changes to MIDI controllers (for example with
      <a class="link" href="ctrlinit.html" title="ctrlinit"><em class="citetitle">ctrlinit</em></a>) will
      also apply to the instrument from which the opcode was called.
    </p>
        <p>
      Use the <a class="link" href="setksmps.html" title="setksmps"><em class="citetitle">setksmps</em></a> opcode to set the local <a class="link" href="ksmps.html" title="ksmps"><em class="citetitle">ksmps</em></a> value.
    </p>
        <p>
      The <a class="link" href="xin.html" title="xin"><em class="citetitle">xin</em></a> and <a class="link" href="xout.html" title="xout"><em class="citetitle">xout</em></a> opcodes copy variables to and from the opcode definition, allowing communication with the calling instrument.
    </p>
        <p>
      The types of input and output variables are defined by the parameters <span class="emphasis"><em>intypes</em></span> and <span class="emphasis"><em>outtypes</em></span>.
      </p>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Tip">
            <tr>
              <td rowspan="2" align="center" valign="top" width="25">
                <img alt="[Tip]" src="images/tip.png" />
              </td>
              <th align="left">Tip</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>
          You can create UDOs which take no inputs or outputs by using 0 instead of a string.</p>
              </td>
            </tr>
          </table>
        </div>
        <p>
    </p>
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Note: Notes">
            <tr>
              <td rowspan="2" align="center" valign="top" width="25">
                <img alt="[Note]" src="images/note.png" />
              </td>
              <th align="left">Notes</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>
        </p>
                <div class="itemizedlist">
                  <ul class="itemizedlist" style="list-style-type: disc; ">
                    <li class="listitem">
                      <p><span class="emphasis"><em>xin</em></span> and <span class="emphasis"><em>xout</em></span> should be called only once, and <span class="emphasis"><em>xin</em></span> should precede <span class="emphasis"><em>xout</em></span>, otherwise an init error and deactivation of the current instrument may occur.</p>
                    </li>
                    <li class="listitem">
                      <p>These opcodes actually run only at i-time. Performance time copying is done by the user opcode call. This means that skipping <span class="emphasis"><em>xin</em></span> or <span class="emphasis"><em>xout</em></span> with <a class="link" href="kgoto.html" title="kgoto"><em class="citetitle">kgoto</em></a> has no effect, while skipping with <a class="link" href="igoto.html" title="igoto"><em class="citetitle">igoto</em></a> affects both init and performance time operation.</p>
                    </li>
                  </ul>
                </div>
                <p>
      </p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="refsect1">
        <a id="idm224144"></a>
        <h2>Syntax</h2>
        <pre class="synopsis"><span class="command"><strong>opcode</strong></span> name, outtypes, intypes</pre>
      </div>
      <div class="refsect1">
        <a id="idm224148"></a>
        <h2>Initialization</h2>
        <p>
      <span class="emphasis"><em>name</em></span> -- name of the opcode. It may consist of any combination of letters, digits, and underscore but should not begin with a digit. If an opcode with the specified name already exists, it is redefined (a warning is printed in such cases). Some reserved words (like <span class="emphasis"><em>instr</em></span> and <span class="emphasis"><em>endin</em></span>) cannot be redefined.
    </p>
        <p>
      <span class="emphasis"><em>intypes</em></span> -- list of input types, any combination of the characters: a, f, k, O, P, V, K, i, o, p, and j. A single 0 character can be used if there are no input arguments. Double quotes and delimiter characters (e.g. comma) are <span class="emphasis"><em>not</em></span> needed.
    </p>
        <p>
      The meaning of the various <span class="emphasis"><em>intypes</em></span> is shown in the following table:

      </p>
        <div class="informaltable">
          <table class="informaltable" border="1">
            <colgroup>
              <col />
              <col />
              <col />
              <col />
            </colgroup>
            <thead>
              <tr>
                <th>Type</th>
                <th>Description</th>
                <th>Variable Types Allowed</th>
                <th>Updated At</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>a</td>
                <td>a-rate variable</td>
                <td>a-rate</td>
                <td>a-rate</td>
              </tr>
              <tr>
                <td>f</td>
                <td>f-sig variable</td>
                <td>f-sig</td>
                <td>k-rate</td>
              </tr>
              <tr>
                <td>i</td>
                <td>i-rate variable</td>
                <td>i-rate</td>
                <td>i-time</td>
              </tr>
              <tr>
                <td>j</td>
                <td>optional i-time, defaults to -1</td>
                <td>i-rate, constant</td>
                <td>i-time</td>
              </tr>
              <tr>
                <td>k</td>
                <td>k-rate variable</td>
                <td>k- and i-rate, constant</td>
                <td>k-rate</td>
              </tr>
              <tr>
                <td>O</td>
                <td>optional k-rate variable, defaults to 0</td>
                <td>k- and i-rate, constant</td>
                <td>k-rate</td>
              </tr>
              <tr>
                <td>P</td>
                <td>optional k-rate variable, defaults to 1</td>
                <td>k- and i-rate, constant</td>
                <td>k-rate</td>
              </tr>
              <tr>
                <td>V</td>
                <td>optional k-rate variable, defaults to 0.5</td>
                <td>k- and i-rate, constant</td>
                <td>k-rate</td>
              </tr>
              <tr>
                <td>J</td>
                <td>optional k-rate variable, defaults to -1</td>
                <td>k- and i-rate, constant</td>
                <td>k-rate</td>
              </tr>
              <tr>
                <td>K</td>
                <td>k-rate with initialization</td>
                <td>k- and i-rate, constant</td>
                <td>i-time and k-rate</td>
              </tr>
              <tr>
                <td>o</td>
                <td>optional i-time, defaults to 0</td>
                <td>i-rate, constant</td>
                <td>i-time</td>
              </tr>
              <tr>
                <td>p</td>
                <td>optional i-time, defaults to 1</td>
                <td>i-rate, constant</td>
                <td>i-time</td>
              </tr>
              <tr>
                <td>S</td>
                <td>string variable</td>
                <td>k- and i-rate string, constant</td>
                <td>i-time and k-rate</td>
              </tr>
            </tbody>
          </table>
        </div>
        <p>
    </p>
        <p>
      <span class="emphasis"><em>outtypes</em></span> -- list of output types. The format is the same as in the case of <span class="emphasis"><em>intypes</em></span>.
    </p>
        <p>
      Here are the available <span class="emphasis"><em>outtypes</em></span>:

      </p>
        <div class="informaltable">
          <table class="informaltable" border="1">
            <colgroup>
              <col />
              <col />
              <col />
              <col />
            </colgroup>
            <thead>
              <tr>
                <th>Type</th>
                <th>Description</th>
                <th>Variable Types Allowed</th>
                <th>Updated At</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>a</td>
                <td>a-rate variable</td>
                <td>a-rate</td>
                <td>a-rate</td>
              </tr>
              <tr>
                <td>f</td>
                <td>f-sig variable</td>
                <td>f-sig</td>
                <td>k-rate</td>
              </tr>
              <tr>
                <td>i</td>
                <td>i-rate variable</td>
                <td>i-rate</td>
                <td>i-time</td>
              </tr>
              <tr>
                <td>k</td>
                <td>k-rate variable</td>
                <td>k-rate</td>
                <td>k-rate</td>
              </tr>
              <tr>
                <td>K</td>
                <td>k-rate with initialization</td>
                <td>k-rate</td>
                <td>i-time and k-rate</td>
              </tr>
              <tr>
                <td>S</td>
                <td>string variable</td>
                <td>k- and i-rate string</td>
                <td>i-time and k-rate</td>
              </tr>
            </tbody>
          </table>
        </div>
        <p>
    </p>
        <p>
      The maximum allowed number of output arguments is 256.
    </p>
        <p>
      The input parameters can be read with <span class="emphasis"><em>xin</em></span>, and the
      output is written by <span class="emphasis"><em>xout</em></span> opcode. Only one instance
      of these units should be used, as <span class="emphasis"><em>xout</em></span> overwrites
      and does not accumulate the output. The number and type of arguments for
      <span class="emphasis"><em>xin</em></span> and <span class="emphasis"><em>xout</em></span> must be the same
      as in the declaration of the user-defined opcode block (see tables above).
    </p>
      </div>
      <div class="refsect1">
        <a id="idm224284"></a>
        <h2>Performance</h2>
        <p>
      The syntax of a user-defined opcode block is as follows:

      </p>
        <pre class="programlisting">
<span class="oblock">opcode</span>  <span class="command"><strong>name</strong></span>, outtypes, intypes
xinarg1 [, xinarg2] [, xinarg3] ... [xinargN]  <span class="opc">xin</span>
[<span class="opc">setksmps</span>  iksmps]
... the rest of the instrument's code.
<span class="opc">xout</span>  xoutarg1 [, xoutarg2] [, xoutarg3] ... [xoutargN]
<span class="oblock">endop</span></pre>
        <p>
    </p>
        <p>
      The new opcode can then be used with the usual syntax:

      </p>
        <pre class="programlisting">
[xoutarg1] [, xoutarg2] ... [xoutargN] <span class="command"><strong>name</strong></span>  [xinarg1] [, xinarg2] ... [xinargN]</pre>
        <p>
    </p>
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Note: Note">
            <tr>
              <td rowspan="2" align="center" valign="top" width="25">
                <img alt="[Note]" src="images/note.png" />
              </td>
              <th align="left">Note</th>
            </tr>
            <tr>
              <td align="left" valign="top">
                <p>
        The opcode call is always executed both at initialization and
        performance time, even if there are no a- or k-rate arguments.
        If there are many user opcode calls that are known to have no
        effect at performance time in an instrument, then it may save some
        CPU time to jump over groups of such opcodes with
        <a class="link" href="kgoto.html" title="kgoto"><em class="citetitle">kgoto</em></a>.
      </p>
              </td>
            </tr>
          </table>
        </div>
      </div>
      <div class="refsect1">
        <a id="idm224302"></a>
        <h2>Examples</h2>
        <p>
      Here is an example of a user-defined opcode. It uses the file
      <a class="ulink" href="examples/opcode_example.csd" target="_top"><em class="citetitle">opcode.csd</em></a>.

      </p>
        <div class="example">
          <a id="idm224307"></a>
          <p class="title">
            <strong>Example 689. Example of a user-defined opcode.</strong>
          </p>
          <div class="example-contents">
            <p>See the sections <a class="link" href="UsingRealTime.html" title="Real-Time Audio"><em class="citetitle">Real-time
        Audio</em></a> and <a class="link" href="CommandFlags.html" title="Csound command line"><em class="citetitle">Command Line
        Flags</em></a> for more information on using command
        line flags.</p>
            <div class="refsect1">
              <a id="idm224314"></a>
              <pre class="programlisting">
<span class="nt">&lt;CsoundSynthesizer&gt;</span>
<span class="nt">&lt;CsOptions&gt;</span>
<span class="c1">; Select audio/midi flags here according to platform</span>
-odac    <span class="c1">;;;realtime audio out</span>
<span class="c1">;-iadc    ;;;uncomment -iadc if realtime audio input is needed too</span>
<span class="c1">; For Non-realtime ouput leave only the line below:</span>
<span class="c1">; -o opcode_example.wav -W ;;; for file output any platform</span>
<span class="nt">&lt;/CsOptions&gt;</span>
<span class="nt">&lt;CsInstruments&gt;</span><span class="w">

</span><span class="vg">sr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">44100</span><span class="w">
</span><span class="vg">ksmps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="w">
</span><span class="vg">nchnls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w">
</span><span class="vg">0dbfs</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w">

</span><span class="cm">/* example opcode 1: simple oscillator */</span><span class="w">

        </span><span class="kd">opcode</span><span class="w"> </span><span class="nf">Oscillator</span><span class="p">,</span><span class="w"> </span><span class="kt">a</span><span class="p">,</span><span class="w"> </span><span class="kt">kk</span><span class="w">

</span>k<span class="n">amp</span><span class="p">,</span><span class="w"> </span>k<span class="n">cps</span><span class="w">      </span><span class="nb">xin</span><span class="w">             </span><span class="c1">; read input parameters</span><span class="w">
</span>a<span class="n">1</span><span class="w">      </span><span class="nb">vco2</span><span class="w"> </span>k<span class="n">amp</span><span class="p">,</span><span class="w"> </span>k<span class="n">cps</span><span class="w">         </span><span class="c1">; sawtooth oscillator</span><span class="w">
        </span><span class="nb">xout</span><span class="w"> </span>a<span class="n">1</span><span class="w">                 </span><span class="c1">; write output</span><span class="w">

        </span><span class="kd">endop</span><span class="w">

</span><span class="cm">/* example opcode 2: lowpass filter with local ksmps */</span><span class="w">

        </span><span class="kd">opcode</span><span class="w"> </span><span class="nf">Lowpass</span><span class="p">,</span><span class="w"> </span><span class="kt">a</span><span class="p">,</span><span class="w"> </span><span class="kt">akk</span><span class="w">

        </span><span class="nb">setksmps</span><span class="w"> </span><span class="mi">1</span><span class="w">              </span><span class="c1">; need sr=kr</span><span class="w">
</span>a<span class="n">in</span><span class="p">,</span><span class="w"> </span>k<span class="n">a1</span><span class="p">,</span><span class="w"> </span>k<span class="n">a2</span><span class="w">   </span><span class="nb">xin</span><span class="w">             </span><span class="c1">; read input parameters</span><span class="w">
</span>a<span class="n">out</span><span class="w">    </span><span class="nb">init</span><span class="w"> </span><span class="mi">0</span><span class="w">                  </span><span class="c1">; initialize output</span><span class="w">
</span>a<span class="n">out</span><span class="w">    </span><span class="o">=</span><span class="w">  </span>a<span class="n">in</span><span class="o">*</span>k<span class="n">a1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>a<span class="n">out</span><span class="o">*</span>k<span class="n">a2</span><span class="w">   </span><span class="c1">; simple tone-like filter</span><span class="w">
        </span><span class="nb">xout</span><span class="w"> </span>a<span class="n">out</span><span class="w">               </span><span class="c1">; write output</span><span class="w">

        </span><span class="kd">endop</span><span class="w">

</span><span class="cm">/* example opcode 3: recursive call */</span><span class="w">

        </span><span class="kd">opcode</span><span class="w"> </span><span class="nf">RecursiveLowpass</span><span class="p">,</span><span class="w"> </span><span class="kt">a</span><span class="p">,</span><span class="w"> </span><span class="kt">akkpp</span><span class="w">

</span>a<span class="n">in</span><span class="p">,</span><span class="w"> </span>k<span class="n">a1</span><span class="p">,</span><span class="w"> </span>k<span class="n">a2</span><span class="p">,</span><span class="w"> </span>i<span class="n">dep</span><span class="p">,</span><span class="w"> </span>i<span class="n">cnt</span><span class="w">       </span><span class="nb">xin</span><span class="w">     </span><span class="c1">; read input parameters</span><span class="w">
        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span>i<span class="n">cnt</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span>i<span class="n">dep</span><span class="p">)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="nl">skip1</span><span class="w">    </span><span class="c1">; check if max depth reached</span><span class="w">
</span>a<span class="n">in</span><span class="w">     </span><span class="nf">RecursiveLowpass</span><span class="w"> </span>a<span class="n">in</span><span class="p">,</span><span class="w"> </span>k<span class="n">a1</span><span class="p">,</span><span class="w"> </span>k<span class="n">a2</span><span class="p">,</span><span class="w"> </span>i<span class="n">dep</span><span class="p">,</span><span class="w"> </span>i<span class="n">cnt</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="w">
</span><span class="nl">skip1</span><span class="p">:</span><span class="w">
</span>a<span class="n">out</span><span class="w">    </span><span class="nf">Lowpass</span><span class="w"> </span>a<span class="n">in</span><span class="p">,</span><span class="w"> </span>k<span class="n">a1</span><span class="p">,</span><span class="w"> </span>k<span class="n">a2</span><span class="w">           </span><span class="c1">; call filter</span><span class="w">
        </span><span class="nb">xout</span><span class="w"> </span>a<span class="n">out</span><span class="w">                       </span><span class="c1">; write output</span><span class="w">

        </span><span class="kd">endop</span><span class="w">

</span><span class="cm">/* example opcode 4: de-click envelope */</span><span class="w">

        </span><span class="kd">opcode</span><span class="w"> </span><span class="nf">DeClick</span><span class="p">,</span><span class="w"> </span><span class="kt">a</span><span class="p">,</span><span class="w"> </span><span class="kt">a</span><span class="w">

</span>a<span class="n">in</span><span class="w">     </span><span class="nb">xin</span><span class="w">
</span>a<span class="n">env</span><span class="w">    </span><span class="nb">linseg</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="vi">p3</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mf">0.05</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.02</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0.01</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w">
        </span><span class="nb">xout</span><span class="w"> </span>a<span class="n">in</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>a<span class="n">env</span><span class="w">         </span><span class="c1">; apply envelope and write output</span><span class="w">

        </span><span class="kd">endop</span><span class="w">

</span><span class="cm">/* instr 1 uses the example opcodes */</span><span class="w">

        </span><span class="kd">instr</span><span class="w"> </span><span class="nf">1</span><span class="w">

</span>k<span class="n">amp</span><span class="w">    </span><span class="o">=</span><span class="w">  </span><span class="mf">.7</span><span class="w">                </span><span class="c1">; amplitude</span><span class="w">
</span>k<span class="n">cps</span><span class="w">    </span><span class="nb">expon</span><span class="w"> </span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="vi">p3</span><span class="p">,</span><span class="w"> </span><span class="mi">500</span><span class="w">       </span><span class="c1">; pitch</span><span class="w">
</span>a<span class="n">1</span><span class="w">      </span><span class="nf">Oscillator</span><span class="w"> </span>k<span class="n">amp</span><span class="p">,</span><span class="w"> </span>k<span class="n">cps</span><span class="w">                   </span><span class="c1">; call oscillator</span><span class="w">
</span>k<span class="n">flt</span><span class="w">    </span><span class="nb">linseg</span><span class="w"> </span><span class="mf">0.4</span><span class="p">,</span><span class="w"> </span><span class="mf">1.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.4</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8</span><span class="p">,</span><span class="w"> </span><span class="mf">1.5</span><span class="p">,</span><span class="w"> </span><span class="mf">0.8</span><span class="w">  </span><span class="c1">; filter envelope</span><span class="w">
</span>a<span class="n">1</span><span class="w">      </span><span class="nf">RecursiveLowpass</span><span class="w"> </span>a<span class="n">1</span><span class="p">,</span><span class="w"> </span>k<span class="n">flt</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span>k<span class="n">flt</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="c1">; 10th order lowpass</span><span class="w">
</span>a<span class="n">1</span><span class="w">      </span><span class="nf">DeClick</span><span class="w"> </span>a<span class="n">1</span><span class="w">
        </span><span class="nb">outs</span><span class="w"> </span>a<span class="n">1</span><span class="p">,</span><span class="w"> </span>a<span class="n">1</span><span class="w">

        </span><span class="kd">endin</span><span class="w">


</span><span class="nt">&lt;/CsInstruments&gt;</span>
<span class="nt">&lt;CsScore&gt;</span><span class="w">

</span><span class="nb">i</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">4</span><span class="w">
</span><span class="nb">e</span><span class="mi">5</span><span class="w">		</span><span class="c1">;extra second before quitting</span><span class="w">

</span><span class="nt">&lt;/CsScore&gt;</span>
<span class="nt">&lt;/CsoundSynthesizer&gt;</span>
</pre>
            </div>
          </div>
        </div>
        <p><br class="example-break" />
    </p>
        <p>
      Here is another example of a user-defined opcode. It uses the file
      <a class="ulink" href="examples/opcode_f.csd" target="_top"><em class="citetitle">opcode_f.csd</em></a>.
      </p>
        <div class="example">
          <a id="idm224729"></a>
          <p class="title">
            <strong>Example 690. Second example of a user-defined opcode.</strong>
          </p>
          <div class="example-contents">
            <div class="refsect1">
              <a id="idm224731"></a>
              <pre class="programlisting">
<span class="nt">&lt;CsoundSynthesizer&gt;</span>
<span class="nt">&lt;CsOptions&gt;</span>
<span class="c1">; Select audio/midi flags here according to platform</span>
-odac    <span class="c1">;;;realtime audio out</span>
<span class="c1">;-iadc    ;;;uncomment -iadc if realtime audio input is needed too</span>
<span class="c1">; For Non-realtime ouput leave only the line below:</span>
<span class="c1">; -o opcode_f.wav -W ;;; for file output any platform</span>
<span class="nt">&lt;/CsOptions&gt;</span>
<span class="nt">&lt;CsInstruments&gt;</span><span class="w">

</span><span class="vg">sr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">44100</span><span class="w">
</span><span class="vg">ksmps</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">32</span><span class="w">
</span><span class="vg">0dbfs</span><span class="w"> </span><span class="o">=</span><span class="w">  </span><span class="mi">1</span><span class="w">
</span><span class="vg">nchnls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w">

</span><span class="c1">; example by Luis Salgueiro and joachim heintz</span><span class="w">

</span><span class="kd">opcode</span><span class="w"> </span><span class="nf">Transpose</span><span class="p">,</span><span class="w"> </span><span class="kt">a</span><span class="p">,</span><span class="w"> </span><span class="kt">fk</span><span class="w">    </span><span class="c1">; transpose a monophonic input signal through FFT.</span><span class="w">
  </span>f<span class="n">sig</span><span class="p">,</span><span class="w"> </span>k<span class="n">Interval</span><span class="w"> </span><span class="nb">xin</span><span class="w">
  </span>f<span class="n">Scaled</span><span class="w"> </span><span class="nb">pvscale</span><span class="w"> </span>f<span class="n">sig</span><span class="p">,</span><span class="w"> </span><span class="nb">semitone</span><span class="p">(</span>k<span class="n">Interval</span><span class="p">)</span><span class="w">
  </span>a<span class="n">Transposed</span><span class="w"> </span><span class="nb">pvsynth</span><span class="w"> </span>f<span class="n">Scaled</span><span class="w">
  </span><span class="nb">xout</span><span class="w"> </span>a<span class="n">Transposed</span><span class="w">
</span><span class="kd">endop</span><span class="w">

</span><span class="kd">opcode</span><span class="w"> </span><span class="nf">Stretch</span><span class="p">,</span><span class="kt">f</span><span class="p">,</span><span class="kt">ik</span><span class="w">
  </span>i<span class="n">Tab</span><span class="p">,</span><span class="w"> </span>k<span class="n">Speed</span><span class="w"> </span><span class="nb">xin</span><span class="w">
  </span>f<span class="n">Stretch</span><span class="w"> </span><span class="nb">pvstanal</span><span class="w"> </span>k<span class="n">Speed</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span>i<span class="n">Tab</span><span class="w">
  </span><span class="nb">xout</span><span class="w"> </span>f<span class="n">Stretch</span><span class="w">
</span><span class="kd">endop</span><span class="w">

</span>gi<span class="n">Fox</span><span class="w"> </span><span class="nb">ftgen</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">"fox.wav"</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w">

</span><span class="kd">instr</span><span class="w"> </span><span class="nf">1</span><span class="w">
  </span>a<span class="n">Snd</span><span class="w"> </span><span class="nb">diskin2</span><span class="w"> </span><span class="s">"fox.wav"</span><span class="w">
  </span>f<span class="n">Snd</span><span class="w"> </span><span class="nb">pvsanal</span><span class="w"> </span>a<span class="n">Snd</span><span class="p">,</span><span class="w"> </span><span class="mi">1024</span><span class="p">,</span><span class="w"> </span><span class="mi">256</span><span class="p">,</span><span class="w"> </span><span class="mi">1024</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w">
  </span>a<span class="n">Transposed</span><span class="w"> </span><span class="nf">Transpose</span><span class="w"> </span>f<span class="n">Snd</span><span class="p">,</span><span class="w"> </span><span class="vi">p4</span><span class="w">   </span><span class="c1">; p4 = transposition in semitones</span><span class="w">
  </span><span class="nb">outall</span><span class="w"> </span>a<span class="n">Transposed</span><span class="o">/</span><span class="mi">2</span><span class="w">
</span><span class="kd">endin</span><span class="w">

</span><span class="kd">instr</span><span class="w"> </span><span class="nf">2</span><span class="w">
  </span>f<span class="n">Stretch</span><span class="w"> </span><span class="nf">Stretch</span><span class="w"> </span>gi<span class="n">Fox</span><span class="p">,</span><span class="w"> </span><span class="nb">transeg</span><span class="p">:</span><span class="kt">k</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="vi">p3</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w">
  </span>a<span class="n">Stretch</span><span class="w"> </span><span class="nb">pvsynth</span><span class="w"> </span>f<span class="n">Stretch</span><span class="w">
  </span><span class="nb">outall</span><span class="w"> </span>a<span class="n">Stretch</span><span class="w">
</span><span class="kd">endin</span><span class="w">

</span><span class="nt">&lt;/CsInstruments&gt;</span>
<span class="nt">&lt;CsScore&gt;</span><span class="w">
</span><span class="nb">i</span><span class="mi">1</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">0</span><span class="w">
</span><span class="nb">i</span><span class="mi">1</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">7</span><span class="w">
</span><span class="nb">i</span><span class="mi">1</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">12</span><span class="w">
</span><span class="nb">i</span><span class="mi">2</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">8</span><span class="w">
</span><span class="nb">e</span><span class="w">
</span><span class="nt">&lt;/CsScore&gt;</span>
<span class="nt">&lt;/CsoundSynthesizer&gt;</span>
</pre>
            </div>
          </div>
        </div>
        <p><br class="example-break" />
    </p>
      </div>
      <div class="refsect1">
        <a id="idm225000"></a>
        <h2>See Also</h2>
        <p>
      <a class="link" href="endop.html" title="endop"><em class="citetitle">endop</em></a>,
      <a class="link" href="setksmps.html" title="setksmps"><em class="citetitle">setksmps</em></a>,
      <a class="link" href="xin.html" title="xin"><em class="citetitle">xin</em></a>,
      <a class="link" href="xout.html" title="xout"><em class="citetitle">xout</em></a>
    </p>
      </div>
      <div class="refsect1">
        <a id="idm225011"></a>
        <h2>Credits</h2>
        <p>Author: Istvan Varga, 2002; based on code by Matt J. Ingalls</p>
        <p>New in version 4.22</p>
      </div>
    </div>
    <div class="navfooter">
      <hr />
      <table width="100%" summary="Navigation footer">
        <tr>
          <td width="40%" align="left"><a accesskey="p" href="olabuffer.html">Prev</a> </td>
          <td width="20%" align="center">
            <a accesskey="u" href="OpcodesTop.html">Up</a>
          </td>
          <td width="40%" align="right"> <a accesskey="n" href="oscbnk.html">Next</a></td>
        </tr>
        <tr>
          <td width="40%" align="left" valign="top">olabuffer </td>
          <td width="20%" align="center">
            <a accesskey="h" href="index.html">Home</a>
          </td>
          <td width="40%" align="right" valign="top"> oscbnk</td>
        </tr>
      </table>
    </div>
  </body>
</html>
